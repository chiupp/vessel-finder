var map=L.map("map",{center:[39.73,-104.99],zoom:10}),osm=L.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:"Â© OpenStreetMap"}).addTo(map),markers=L.layerGroup().addTo(map),radarMarkers=L.layerGroup().addTo(map),baseMaps={OpenStreetMap:osm},overlayMaps={"AIS Data":markers,"Radar Data":radarMarkers},layerControl=L.control.layers(baseMaps,overlayMaps).addTo(map),socket=new WebSocket("ws://localhost:8765/");function updateMapMarkers(a){aisMarkers.clearLayers(),Object.entries(a).forEach(function([a,r]){var e=r[1],t=r[0],o=r[2],s=r[3],d=r[4],p=r[5],i=r[6],n=r[7],m=a,u=L.marker([e,t]),c="MMSI: "+m+"<br>Time: "+o+"<br>Latitude: "+e+"<br>Longitude: "+t+"<br>SOG: "+i+"<br>COG: "+n;d&&(c+="<br>Ship Name: "+d),p&&(c+="<br>Ship Type: "+p),s&&(c+='<br><img src="'+s+'" width="120" height="100">'),u.bindPopup(c,{autoClose:!1}),aisMarkers.addLayer(u)})}function updateRadarData(a){radarMarkers.clearLayers(),a.forEach(function(a){var r=a[1],e=a[0],t=L.marker([r,e]),o="Latitude: "+r+"<br>Longitude: "+e;t.bindPopup(o,{autoClose:!1}),radarMarkers.addLayer(t)})}socket.onmessage=function(a){var r=JSON.parse(a.data);(console.log("Received data:",r),r.radarDataList)?updateRadarData(r.radarDataList):updateMapMarkers(r)};